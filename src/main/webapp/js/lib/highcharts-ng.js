if(typeof module!=="undefined"&&typeof exports!=="undefined"&&module.exports===exports){module.exports="highcharts-ng"}(function(){"use strict";function e(){return{indexOf:function(e,t,n){if(n===undefined)n=0;if(n<0)n+=e.length;if(n<0)n=0;for(var r=e.length;n<r;n++)if(n in e&&e[n]===t)return n;return-1},prependMethod:function(e,t,n){var r=e[t];e[t]=function(){var e=Array.prototype.slice.call(arguments);n.apply(this,e);if(r){return r.apply(this,e)}else{return}}},deepExtend:function e(t,n){if(angular.isArray(n)){t=angular.isArray(t)?t:[];for(var r=0;r<n.length;r++){t[r]=e(t[r]||{},n[r])}}else if(angular.isObject(n)){for(var i in n){t[i]=e(t[i]||{},n[i])}}else{t=n}return t}}}function t(e,t){var n=0;var r=function(e){var t=false;angular.forEach(e,function(e){if(!angular.isDefined(e.id)){e.id="series-"+n++;t=true}});return t};var i=["xAxis","yAxis"];var s=function(t,n,r){var s={};var o={chart:{events:{}},title:{},subtitle:{},series:[],credits:{},plotOptions:{},navigator:{enabled:false}};if(r.options){s=e.deepExtend(o,r.options)}else{s=o}s.chart.renderTo=n[0];angular.forEach(i,function(n){if(angular.isDefined(r[n])){s[n]=angular.copy(r[n]);if(angular.isDefined(r[n].currentMin)||angular.isDefined(r[n].currentMax)){e.prependMethod(s.chart.events,"selection",function(e){var r=this;if(e[n]){t.$apply(function(){t.config[n].currentMin=e[n][0].min;t.config[n].currentMax=e[n][0].max})}else{t.$apply(function(){t.config[n].currentMin=r[n][0].dataMin;t.config[n].currentMax=r[n][0].dataMax})}});e.prependMethod(s.chart.events,"addSeries",function(e){t.config[n].currentMin=this[n][0].min||t.config[n].currentMin;t.config[n].currentMax=this[n][0].max||t.config[n].currentMax})}}});if(r.title){s.title=r.title}if(r.subtitle){s.subtitle=r.subtitle}if(r.credits){s.credits=r.credits}if(r.size){if(r.size.width){s.chart.width=r.size.width}if(r.size.height){s.chart.height=r.size.height}}return s};var o=function(e,t){var n=e.getExtremes();if(t.currentMin!==n.dataMin||t.currentMax!==n.dataMax){e.setExtremes(t.currentMin,t.currentMax,false)}};var u=function(e,t,n){if(t.currentMin||t.currentMax){e[n][0].setExtremes(t.currentMin,t.currentMax,true)}};var a=function(e){return angular.extend({},e,{data:null,visible:null})};return{restrict:"EAC",replace:true,template:"<div></div>",scope:{config:"=",disableDataWatch:"="},link:function(n,f,l){var c={};var h=function(t){var i;var s=[];if(t){var o=r(t);if(o){return false}angular.forEach(t,function(e){s.push(e.id);var t=p.get(e.id);if(t){if(!angular.equals(c[e.id],a(e))){t.update(angular.copy(e),false)}else{if(e.visible!==undefined&&t.visible!==e.visible){t.setVisible(e.visible,false)}t.setData(angular.copy(e.data),false)}}else{p.addSeries(angular.copy(e),false)}c[e.id]=a(e)});if(n.config.noData){var u=false;for(i=0;i<t.length;i++){if(t[i].data&&t[i].data.length>0){u=true;break}}if(!u){p.showLoading(n.config.noData)}else{p.hideLoading()}}}for(i=p.series.length-1;i>=0;i--){var f=p.series[i];if(f.options.id!=="highcharts-navigator-series"&&e.indexOf(s,f.options.id)<0){f.remove(false)}}return true};var p=false;var d=function(){Highcharts.setOptions({global:{useUTC:false}});if(p)p.destroy();c={};var e=n.config||{};var t=s(n,f,e);var r=e.func||undefined;p=e.useHighStocks?new Highcharts.StockChart(t,r):new Highcharts.Chart(t,r);for(var o=0;o<i.length;o++){if(e[i[o]]){u(p,e[i[o]],i[o])}}if(e.loading){p.showLoading()}};d();if(n.disableDataWatch){n.$watchCollection("config.series",function(e,t){h(e);p.redraw()})}else{n.$watch("config.series",function(e,t){var n=h(e);if(n){p.redraw()}},true)}n.$watch("config.title",function(e){p.setTitle(e,true)},true);n.$watch("config.subtitle",function(e){p.setTitle(true,e)},true);n.$watch("config.loading",function(e){if(e){p.showLoading()}else{p.hideLoading()}});n.$watch("config.credits.enabled",function(e){if(e){p.credits.show()}else if(p.credits){p.credits.hide()}});n.$watch("config.useHighStocks",function(e,t){if(e===t)return;d()});angular.forEach(i,function(e){n.$watch("config."+e,function(t,n){if(t===n)return;if(t){p[e][0].update(t,false);o(p[e][0],angular.copy(t));p.redraw()}},true)});n.$watch("config.options",function(e,t,n){if(e===t)return;d();h(n.config.series);p.redraw()},true);n.$watch("config.size",function(e,t){if(e===t)return;if(e){p.setSize(e.width||undefined,e.height||undefined)}},true);n.$on("highchartsng.reflow",function(){p.reflow()});n.$on("$destroy",function(){if(p){p.destroy();t(function(){f.remove()},0)}})}}}angular.module("highcharts-ng",[]).factory("highchartsNGUtils",e).directive("highchart",["highchartsNGUtils","$timeout",t])})()